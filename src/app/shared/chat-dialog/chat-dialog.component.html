<div class="chat-dialog-container">

  <h3 mat-dialog-title>Chat com {{ data.name || ('Aluno #' + data.id) }}</h3>

  <mat-dialog-content>
    <div #messagesContainer class="messages">
      <div
        *ngFor="let m of messages"
        class="message"
        [ngClass]="{ mine: m.from === 'me', other: m.from === 'other' }"
      >
        <div class="bubble">
          <span class="text">{{ m.text }}</span>
          <img *ngIf="m.dataUrl" [src]="m.dataUrl" alt="Screenshot" style="max-width:100%; border-radius:8px" />
          <small class="time">{{ m.at }}</small>
        </div>
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions class="actions">
    <mat-form-field class="message-field" appearance="outline">
      <input
        matInput
        placeholder="Digite sua mensagem"
        [formControl]="messageControl"
        (keydown.enter)="send()"
        class="chat-input"
      />
    </mat-form-field>

    <button class="send-button" color="primary" (click)="send()" [disabled]="messageControl.invalid" matTooltip="Enviar mensagem">
      <mat-icon>send</mat-icon>
    </button>

    <button class="screen-share-button" (click)="socketService.requestScreenShot(data.id.toString())" matTooltip="Solicitar captura de tela">
      <mat-icon>screen_share</mat-icon>
    </button>

    <button class="close-button" (click)="close()" matTooltip="Fechar">
      <mat-icon>close</mat-icon>
    </button>
  </mat-dialog-actions>
</div>